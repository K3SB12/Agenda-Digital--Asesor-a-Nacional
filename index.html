<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agenda Digital - Asesor Nacional DRTE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- HEADER PRINCIPAL -->
        <header class="main-header">
            <div class="logo-section">
                <div class="logo-icon">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <div class="logo-text">
                    <h1>Agenda Digital DRTE</h1>
                    <p>Asesor Nacional - Departamento de Investigación, Desarrollo e Implementación</p>
                </div>
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="openModal('profile-modal')">
                    <i class="fas fa-user"></i> Perfil
                </button>
                <button class="btn btn-primary" onclick="exportToExcel()">
                    <i class="fas fa-file-excel"></i> Exportar Excel
                </button>
                <button class="btn btn-success" onclick="printReport()">
                    <i class="fas fa-print"></i> Imprimir
                </button>
                <button class="btn btn-secondary" id="theme-toggle">
                    <i class="fas fa-moon"></i> Tema
                </button>
            </div>
        </header>

        <!-- BARRA DE BÚSQUEDA -->
        <div class="search-section">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="search-input" placeholder="Buscar en tareas, descripciones, categorías...">
                <button class="btn btn-sm" onclick="clearSearch()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- PANEL DE NAVEGACIÓN -->
        <div class="nav-panel">
            <div class="nav-item active" onclick="openTaskModal('task')">
                <div class="nav-icon">
                    <i class="fas fa-tasks"></i>
                </div>
                <h3>Nueva Tarea</h3>
                <p>Registrar actividades diarias del PNFT</p>
            </div>
            
            <div class="nav-item" onclick="openTaskModal('meeting')">
                <div class="nav-icon">
                    <i class="fas fa-users"></i>
                </div>
                <h3>Reunión</h3>
                <p>Agendar reuniones con el equipo</p>
            </div>
            
            <div class="nav-item" onclick="openTaskModal('training')">
                <div class="nav-icon">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h3>Capacitación</h3>
                <p>Registrar talleres y cursos</p>
            </div>
            
            <div class="nav-item" onclick="openModal('evidence-modal')">
                <div class="nav-icon">
                    <i class="fas fa-file-upload"></i>
                </div>
                <h3>Evidencias</h3>
                <p>Gestionar archivos de soporte</p>
            </div>
        </div>

        <!-- CALENDARIO -->
        <section class="calendar-section">
            <div class="calendar-header">
                <div class="calendar-nav">
                    <button class="calendar-nav-btn" onclick="changeMonth(-1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <h2 class="current-month" id="current-month"></h2>
                    <button class="calendar-nav-btn" onclick="changeMonth(1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <div class="calendar-view-options">
                    <button class="view-option" onclick="changeView('day')">Día</button>
                    <button class="view-option active" onclick="changeView('month')">Mes</button>
                    <button class="view-option" onclick="changeView('week')">Semana</button>
                </div>
                <button class="btn btn-sm" onclick="goToToday()">
                    <i class="fas fa-calendar-day"></i> Hoy
                </button>
            </div>
            <div class="calendar-grid" id="calendar-grid">
                <!-- Generado dinámicamente -->
            </div>
        </section>

        <!-- TAREAS DEL DÍA -->
        <section class="tasks-section">
            <div class="section-header">
                <h2 class="section-title">
                    <i class="fas fa-clipboard-list"></i>
                    <span id="tasks-title">Tareas del Día</span>
                </h2>
                <div class="task-stats">
                    <span class="stat-item">
                        <i class="fas fa-clock"></i>
                        <span id="pending-count">0</span> Pendientes
                    </span>
                    <span class="stat-item">
                        <i class="fas fa-check-circle"></i>
                        <span id="completed-count">0</span> Completadas
                    </span>
                    <span class="stat-item">
                        <i class="fas fa-chart-bar"></i>
                        <span id="total-count">0</span> Total
                    </span>
                </div>
            </div>
            
            <div class="task-filters">
                <button class="filter-btn active" onclick="filterTasks('all')">Todas</button>
                <button class="filter-btn" onclick="filterTasks('pending')">Pendientes</button>
                <button class="filter-btn" onclick="filterTasks('completed')">Completadas</button>
                <button class="filter-btn" onclick="filterTasks('pntf')">PNFT</button>
                <button class="filter-btn" onclick="filterTasks('meeting')">Reuniones</button>
                <button class="filter-btn" onclick="filterTasks('training')">Capacitaciones</button>
                <button class="filter-btn" onclick="filterTasks('office')">
                    <i class="fas fa-building"></i> Oficina
                </button>
                <button class="filter-btn" onclick="filterTasks('remote')">
                    <i class="fas fa-home"></i> Teletrabajo
                </button>
            </div>
            
            <div class="task-list" id="task-list">
                <!-- Tareas cargadas dinámicamente -->
            </div>
        </section>

        <!-- PANEL DE ESTADÍSTICAS -->
        <section class="stats-section">
            <h2 class="section-title">
                <i class="fas fa-chart-line"></i>
                Estadísticas de Productividad
            </h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(102, 126, 234, 0.2);">
                        <i class="fas fa-tasks" style="color: #667eea;"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="week-tasks">0</h3>
                        <p>Tareas esta semana</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(46, 213, 115, 0.2);">
                        <i class="fas fa-check-circle" style="color: #2ed573;"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="completion-rate">0%</h3>
                        <p>Tasa de completado</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(255, 165, 2, 0.2);">
                        <i class="fas fa-users" style="color: #ffa502;"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="meetings-count">0</h3>
                        <p>Reuniones este mes</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background: rgba(118, 75, 162, 0.2);">
                        <i class="fas fa-file-upload" style="color: #764ba2;"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="files-count">0</h3>
                        <p>Archivos subidos</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ENLACES RÁPIDOS -->
        <section class="quick-links-section">
            <h2 class="section-title">
                <i class="fas fa-link"></i>
                Enlaces Importantes
            </h2>
            
            <div class="links-grid">
                <a href="https://pnft.mep.go.cr/asesoriapnft/app/home" target="_blank" class="link-card">
                    <div class="link-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <div class="link-info">
                        <h4>PNFT - Sistema Principal</h4>
                        <span>Plataforma oficial del Programa Nacional</span>
                    </div>
                </a>
                
                <a href="https://adminmepcr-my.sharepoint.com/:o:/r/personal/kevin_sanchez_bogarin_mep_go_cr/Documents/Notebooks/Informe%20Teletrabajo%20Kevin%20S%C3%A1nchez%20B_2025" target="_blank" class="link-card">
                    <div class="link-icon">
                        <i class="fas fa-sticky-note"></i>
                    </div>
                    <div class="link-info">
                        <h4>OneNote - Bitácora</h4>
                        <span>Notas personales y seguimiento</span>
                    </div>
                </a>
                
                <a href="https://adminmepcr.sharepoint.com/sites/DRTE-Intranet/DOCUMENTOSASESORESDRTE/Forms/AllItems.aspx" target="_blank" class="link-card">
                    <div class="link-icon">
                        <i class="fas fa-folder"></i>
                    </div>
                    <div class="link-info">
                        <h4>Documentos DRTE</h4>
                        <span>Archivos compartidos institucionales</span>
                    </div>
                </a>
                
                <a href="https://www.symbaloo.com/home/mix/13eP7Bh97Y" target="_blank" class="link-card">
                    <div class="link-icon">
                        <i class="fas fa-th-large"></i>
                    </div>
                    <div class="link-info">
                        <h4>Symbaloo - Recursos</h4>
                        <span>Acceso rápido a herramientas</span>
                    </div>
                </a>
                
                <a href="https://adminmepcr.sharepoint.com/sites/DiseoMallaCurricular-Enmallados/Documentos%20compartidos/Forms/AllItems.aspx" target="_blank" class="link-card">
                    <div class="link-icon">
                        <i class="fas fa-project-diagram"></i>
                    </div>
                    <div class="link-info">
                        <h4>Mallas Curriculares</h4>
                        <span>Documentación de diseño curricular</span>
                    </div>
                </a>
                
                <a href="#" onclick="openModal('email-modal')" class="link-card">
                    <div class="link-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="link-info">
                        <h4>Correo Institucional</h4>
                        <span>Acceso al correo MEP</span>
                    </div>
                </a>
            </div>
        </section>
    </div>

    <!-- MODAL NUEVA TAREA -->
    <div id="task-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('task-modal')">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="section-title">
                <i class="fas fa-plus-circle"></i>
                <span id="modal-title">Nueva Tarea</span>
            </h2>
            
            <form id="task-form">
                <input type="hidden" id="task-id">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-title"><i class="fas fa-heading"></i> Título *</label>
                        <input type="text" id="task-title" class="form-control" placeholder="Ej: Revisión de diseño instruccional" required>
                    </div>
                    
                    <div class="form-group">
                        <label><i class="fas fa-tag"></i> Tipo de Tarea *</label>
                        <div class="category-selector">
                            <div class="category-option" data-value="pntf" onclick="selectCategory('pntf')">
                                <i class="fas fa-chalkboard-teacher"></i>
                                <span>PNFT</span>
                            </div>
                            <div class="category-option" data-value="meeting" onclick="selectCategory('meeting')">
                                <i class="fas fa-users"></i>
                                <span>Reunión</span>
                            </div>
                            <div class="category-option" data-value="training" onclick="selectCategory('training')">
                                <i class="fas fa-graduation-cap"></i>
                                <span>Capacitación</span>
                            </div>
                            <div class="category-option" data-value="design" onclick="selectCategory('design')">
                                <i class="fas fa-pencil-ruler"></i>
                                <span>Diseño</span>
                            </div>
                            <div class="category-option" data-value="report" onclick="selectCategory('report')">
                                <i class="fas fa-file-alt"></i>
                                <span>Informe</span>
                            </div>
                            <div class="category-option" data-value="system" onclick="selectCategory('system')">
                                <i class="fas fa-database"></i>
                                <span>Sistemas</span>
                            </div>
                        </div>
                        <input type="hidden" id="task-category" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-date"><i class="fas fa-calendar"></i> Fecha *</label>
                        <input type="date" id="task-date" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="task-time"><i class="fas fa-clock"></i> Hora</label>
                        <input type="time" id="task-time" class="form-control">
                    </div>
                    
                    <div class="form-group">
                        <label for="task-priority"><i class="fas fa-exclamation-circle"></i> Prioridad</label>
                        <select id="task-priority" class="form-control select-control">
                            <option value="low">Baja</option>
                            <option value="medium" selected>Media</option>
                            <option value="high">Alta</option>
                            <option value="urgent">Urgente</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="task-description"><i class="fas fa-align-left"></i> Descripción Detallada *</label>
                    <textarea id="task-description" class="form-control" rows="4" 
                              placeholder="Describa la actividad, objetivos, acciones realizadas, resultados esperados..." 
                              required></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="task-location"><i class="fas fa-map-marker-alt"></i> Ubicación</label>
                        <div class="location-selector">
                            <button type="button" class="location-option" data-value="office" onclick="selectLocation('office')">
                                <i class="fas fa-building"></i>
                                <span>Oficina</span>
                            </button>
                            <button type="button" class="location-option active" data-value="remote" onclick="selectLocation('remote')">
                                <i class="fas fa-home"></i>
                                <span>Teletrabajo</span>
                            </button>
                            <button type="button" class="location-option" data-value="mixed" onclick="selectLocation('mixed')">
                                <i class="fas fa-random"></i>
                                <span>Mixto</span>
                            </button>
                        </div>
                        <input type="hidden" id="task-location" value="remote">
                    </div>
                    
                    <div class="form-group">
                        <label for="task-status"><i class="fas fa-check-circle"></i> Estado</label>
                        <select id="task-status" class="form-control select-control">
                            <option value="pending">Pendiente</option>
                            <option value="in-progress">En Progreso</option>
                            <option value="completed">Completado</option>
                        </select>
                    </div>
                </div>
                
                <!-- SUBIDA DE ARCHIVOS MEJORADA -->
                <div class="form-group">
                    <label><i class="fas fa-paperclip"></i> Adjuntar Evidencias</label>
                    <div class="file-upload-section">
                        <div class="upload-area" id="upload-area" onclick="document.getElementById('file-input').click()">
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <div class="upload-text">
                                Arrastra archivos aquí o haz clic para subir
                            </div>
                            <div class="upload-hint">
                                Formatos: JPG, PNG, PDF, DOCX, PPT, CSV, HTML (Máx. 10MB)
                            </div>
                        </div>
                        <input type="file" id="file-input" multiple style="display: none;" 
                               accept=".jpg,.jpeg,.png,.pdf,.docx,.ppt,.pptx,.csv,.html,.txt">
                        <div class="file-list" id="file-list">
                            <!-- Archivos subidos aparecen aquí -->
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label><i class="fas fa-bell"></i> Recordatorio</label>
                    <div class="reminder-options">
                        <label class="checkbox-label">
                            <input type="checkbox" id="task-reminder">
                            <span>Activar recordatorio</span>
                        </label>
                        <select id="reminder-time" class="form-control select-control" style="margin-top: 10px;" disabled>
                            <option value="5">5 minutos antes</option>
                            <option value="15">15 minutos antes</option>
                            <option value="30">30 minutos antes</option>
                            <option value="60">1 hora antes</option>
                            <option value="1440">1 día antes</option>
                        </select>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('task-modal')">
                        <i class="fas fa-times"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-warning" onclick="saveAsTemplate()" id="template-btn">
                        <i class="fas fa-save"></i> Guardar Plantilla
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Guardar Tarea
                    </button>
                    <button type="button" class="btn btn-success" onclick="saveAndEmail()" id="email-btn">
                        <i class="fas fa-paper-plane"></i> Guardar y Enviar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL PREVISUALIZACIÓN DE IMÁGENES -->
    <div id="image-modal" class="modal">
        <div class="modal-content" style="max-width: 90%; max-height: 90%;">
            <button class="modal-close" onclick="closeModal('image-modal')">
                <i class="fas fa-times"></i>
            </button>
            <div class="image-viewer">
                <img id="modal-image" src="" alt="Previsualización">
                <div class="image-info">
                    <h4 id="image-name"></h4>
                    <span id="image-size"></span>
                </div>
                <div class="image-nav">
                    <button class="btn btn-secondary" onclick="prevImage()">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <a id="download-image" class="btn btn-primary" download>
                        <i class="fas fa-download"></i> Descargar
                    </a>
                    <button class="btn btn-secondary" onclick="nextImage()">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL GESTIÓN DE EVIDENCIAS -->
    <div id="evidence-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('evidence-modal')">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="section-title">
                <i class="fas fa-archive"></i>
                Gestión de Evidencias
            </h2>
            
            <div class="evidence-controls">
                <button class="btn btn-primary" onclick="backupToDrive()">
                    <i class="fas fa-cloud-upload-alt"></i> Backup a Drive
                </button>
                <button class="btn btn-success" onclick="downloadAllFiles()">
                    <i class="fas fa-download"></i> Descargar Todo
                </button>
                <button class="btn btn-secondary" onclick="clearOldFiles()">
                    <i class="fas fa-trash"></i> Limpiar Antiguos
                </button>
            </div>
            
            <div class="evidence-grid" id="evidence-grid">
                <!-- Evidencias cargadas dinámicamente -->
            </div>
        </div>
    </div>

    <!-- MODAL HORARIO SEMANAL -->
    <div id="schedule-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('schedule-modal')">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="section-title">
                <i class="fas fa-calendar-alt"></i>
                Horario Semanal - Asesor Nacional
            </h2>
            
            <div class="schedule-grid">
                <div class="schedule-day">
                    <div class="day-header">Lunes</div>
                    <div class="day-schedule office-day">
                        <i class="fas fa-building"></i>
                        <strong>Oficina DRTE</strong>
                        <p>8:00 AM - 4:00 PM</p>
                        <span class="badge">Presencial</span>
                    </div>
                </div>
                <div class="schedule-day">
                    <div class="day-header">Martes</div>
                    <div class="day-schedule remote-day">
                        <i class="fas fa-home"></i>
                        <strong>Teletrabajo</strong>
                        <p>7:30 AM - 5:00 PM</p>
                        <span class="badge">Remoto</span>
                    </div>
                </div>
                <div class="schedule-day">
                    <div class="day-header">Miércoles</div>
                    <div class="day-schedule remote-day">
                        <i class="fas fa-home"></i>
                        <strong>Teletrabajo</strong>
                        <p>7:30 AM - 5:00 PM</p>
                        <span class="badge">Remoto</span>
                    </div>
                </div>
                <div class="schedule-day">
                    <div class="day-header">Jueves</div>
                    <div class="day-schedule remote-day">
                        <i class="fas fa-home"></i>
                        <strong>Teletrabajo</strong>
                        <p>7:30 AM - 5:00 PM</p>
                        <span class="badge">Remoto</span>
                    </div>
                </div>
                <div class="schedule-day">
                    <div class="day-header">Viernes</div>
                    <div class="day-schedule remote-day">
                        <i class="fas fa-home"></i>
                        <strong>Teletrabajo</strong>
                        <p>7:30 AM - 4:00 PM</p>
                        <span class="badge">Remoto</span>
                    </div>
                </div>
            </div>
            
            <div class="schedule-notes">
                <h4><i class="fas fa-info-circle"></i> Notas Importantes:</h4>
                <ul>
                    <li>Los lunes son días <strong>presenciales obligatorios</strong> en oficina</li>
                    <li>Martes a viernes: modalidad de <strong>teletrabajo</strong></li>
                    <li>Horario flexible con disponibilidad para reuniones virtuales</li>
                    <li>Reportes semanales se envían los viernes antes de las 3:00 PM</li>
                    <li>Reuniones de equipo: Miércoles 10:00 AM (virtual)</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- MODAL PLANTILLAS -->
    <div id="templates-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('templates-modal')">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="section-title">
                <i class="fas fa-layer-group"></i>
                Plantillas de Tareas Recurrentes
            </h2>
            
            <div class="templates-grid" id="templates-grid">
                <!-- Plantillas cargadas dinámicamente -->
            </div>
            
            <div class="modal-actions" style="margin-top: 30px;">
                <button class="btn btn-primary" onclick="createNewTemplate()">
                    <i class="fas fa-plus"></i> Crear Nueva Plantilla
                </button>
            </div>
        </div>
    </div>

    <!-- NOTIFICACIONES -->
    <div id="notification-container"></div>

    <!-- SCRIPTS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="app.js"></script>
    <script>
        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
    </script>
</body>
</html>
